/**
* jCS4 - jQuery CSS Slide Show
*
* @version: 0.3.1
* @author Edir Pedro
* @website http://hub.edirpedro.com.br/jcs4
* @git https://github.com/edirpedro/jcs4
* @copyright 2015
* @license MIT - http://opensource.org/licenses/MIT
* @preserve
*/
!function(a){"use strict";var b={debug:!1,autoPlay:!0,pauseOnHover:!0,imgOnDemand:!1,touchEnabled:!0,swipeThreshold:100,swipeInvert:!1,slide:".jcs4-slide",slideDuration:5e3,slideToStart:0,slideWidth:0,slideHeight:0,slideOutWait:0,autoPages:!0,controlPrevious:".jcs4-prev",controlNext:".jcs4-next",controlPages:".jcs4-pages",onPrevious:function(a,b){},onNext:function(a,b){},onChange:function(a,b){},onLoad:function(){}};a.extend({jcs4Find:function(a,b){for(var c in b){var d=jQuery(a,b[c]);if(d.length)return d}return jQuery()}}),a.fn.jCS4=function(c){if(0===this.length)return this;if(this.length>1)return this.each(function(){a(this).jCS4(c)}),this;var d=this,e=function(){if(d.settings=a.extend({},b,c),d.addClass("loading"),d.preloadAll=!1,d.original=d.find(d.settings.slide).clone(),d.find(d.settings.slide).each(function(b){a(this).attr("data-index",b)}),d.slides=d.find(d.settings.slide).clone(),d.viewport=d.find(".jcs4-viewport"),d.viewport.html('<div class="jcs4-loading" style="display:none;"></div>'),d.settings.slideWidth>0&&d.settings.slideHeight>0){var e='<style>.jcs4-viewport { max-height: $height$px; } .jcs4-viewport::before { display: block; content: ""; width: 100%; padding-top: $ratio$%; }</style>';e=e.replace("$height$",d.settings.slideHeight),e=e.replace("$ratio$",d.settings.slideHeight/d.settings.slideWidth*100),a("head").append(e)}if(d.settings.autoPages){var g=a.jcs4Find(d.settings.controlPages,[d,document]);a.each(d.slides,function(a){g.append("<a>"+(a+1)+"</a>")})}a.jcs4Find(d.settings.controlPrevious,[d,document]).on("click",f),a.jcs4Find(d.settings.controlNext,[d,document]).on("click",h),a.jcs4Find(d.settings.controlPages,[d,document]).find("a").each(function(b){a(this).attr("data-index",b).on("click",j)}),d.queue={front:d.settings.slideToStart,back:d.settings.slideToStart},d.slideIn=null,d.timer=new n(d,i,d.settings.slideDuration),d.hover=!1,d.settings.pauseOnHover&&a(d).hover(function(){d.hover=!0,d.timer.pause()},function(){d.hover=!1,d.timer.start()}),s("Initialized",d),d.settings.onLoad(),l(d.settings.slideToStart,function(){o(),d.removeClass("loading")})},f=function(a){a.preventDefault(),g()},g=function(){var a=d.slides.length-1;d.queue.front>0&&(a=parseInt(d.queue.front)-1),s("Function controlPrevious",a,d.queue.front),l(a),d.settings.onPrevious(d.queue.front,d.queue.back)},h=function(a){a.preventDefault(),i()},i=function(){var a=0;d.queue.front<d.slides.length-1&&(a=parseInt(d.queue.front)+1),s("Function controlNext",a,d.queue.front),l(a),d.settings.onNext(d.queue.front,d.queue.back)},j=function(b){b.preventDefault();var c=a(b.currentTarget).attr("data-index");c!=d.queue.front&&(s("Function clickPages",b,c),l(c))},k=function(){a.jcs4Find(d.settings.controlPages,[d,document]).find("a").removeClass("active").filter("[data-index="+d.queue.front+"]").addClass("active")},l=function(b,c){d.timer.stop(),clearTimeout(d.slideIn),q(d.slides.filter("[data-index="+b+"]"),function(b){var e=d.viewport.find(d.settings.slide);2==e.length&&a(e).eq(0).remove();var f=d.viewport.find(d.settings.slide).filter(":first");f=m(f,"out");var g=a(d.slides[b]).clone();g=m(g,"in"),f?d.slideIn=setTimeout(function(){d.viewport.append(g)},d.settings.slideOutWait):d.viewport.append(g),d.queue.back=d.queue.front,d.queue.front=b,s("Function goToSlide",b),d.settings.onChange(d.queue.front,d.queue.back),k(),d.timer.start(),d.settings.imgOnDemand===!1&&d.preloadAll===!1&&r(0),c&&c()},b,!0)},m=function(b,c){var d="webkitAnimationStart mozAnimationStart MSAnimationStart oanimationstart animationstart",e={"in":{"data-delay":"animation-delay","data-delay-in":"animation-delay","data-direction":"animation-direction","data-direction-in":"animation-direction","data-duration":"animation-duration","data-duration-in":"animation-duration","data-iteration-count":"animation-iteration-count","data-iteration-count-in":"animation-iteration-count","data-timing-function":"animation-timing-function","data-timing-function-in":"animation-timing-function"},out:{"data-delay-out":"animation-delay","data-direction-out":"animation-direction","data-duration-out":"animation-duration","data-iteration-count-out":"animation-iteration-count","data-timing-function-out":"animation-timing-function"}},f=!1,g="out"==c?"[data-effect-out]":"[data-effect], [data-effect-in]";return b.find(g).each(function(){var b=a(this);f=!0;var g="";"out"==c?g=b.attr("data-effect-out"):(g=b.attr("data-effect"),void 0==g&&(g=b.attr("data-effect-in")));var h=g;"in"==c&&(h+=" animationHidden"),b.removeClass(b.data("classes")).addClass(h).data("classes",h);var i=[];for(var j in e[c]){var k=b.attr(j);"string"==typeof k&&i.push(p(e[c][j],k))}b.attr("style",i.join(" ")),b.one(d,function(){a(this).removeClass("animationHidden")})}),f?b:null},n=function(a,b,c){var d,e,f=c;this.start=function(){a.settings.autoPlay===!1||a.hover||(e=new Date,d=setTimeout(b,f),s("Timer Start",f))},this.pause=function(){clearTimeout(d),f-=new Date-e,s("Timer Pause",f)},this.stop=function(){clearTimeout(d),f=c,s("Timer Stop",c)}},o=function(){d.settings.touchEnabled&&(d.touch={},d.on("touchstart",function(a){d.touch.startX=a.originalEvent.touches[0].pageX}).on("touchmove",function(a){d.touch.endX=a.originalEvent.touches[0].pageX}).on("touchend",function(a){var b=d.touch.startX,c=d.touch.endX,e=Math.abs(b-c);e>=d.settings.swipeThreshold&&(d.settings.swipeInvert?b>c?g():i():b>c?i():g())}),s("Touch events initiated"))},p=function(a,b){var c=document.createElement("div").style,d=["-ms-","-o-","-moz-","-webkit-"];if(""==c[a])return a+": "+b+";";for(var e in d){var f=d[e]+a;if(""==c[f])return f+": "+b+";"}},q=function(b,c,e,f){var g=b.find("[data-src]").length;if(0==g)return void c(e);f&&d.find(".jcs4-loading").show();var h=0;b.find("[data-src]").each(function(){a(this).attr("src",a(this).attr("data-src")).one("load",function(){a(this).removeAttr("data-src"),++h==g&&(d.find(".jcs4-loading").hide(),c(e))}).each(function(){this.complete&&a(this).load()})})},r=function(a){if(d.preloadAll=!0,a<d.slides.length){s("Function preloadAll",a);var b=d.slides.filter("[data-index="+a+"]");q(b,function(){r(a+1)},a,!1)}},s=function(){d.settings.debug&&console.log(Array.prototype.slice.call(arguments))};return d.goToPrevious=function(){s("Public goToPrevious",index),g()},d.goToNext=function(){s("Public goToNext"),i()},d.goToSlide=function(a){s("Public goToSlide",a),l(a)},d.getCurrentSlide=function(){return d.queue.front},d.getBackSlide=function(){return d.queue.back},d.getSlideCount=function(){return d.slides.length},d.destroy=function(){s("Public destroy"),d.off("touchstart touchmove touchend"),d.viewport.html(d.original),a.jcs4Find(d.settings.controlPrevious,[d,document]).off("click"),a.jcs4Find(d.settings.controlNext,[d,document]).off("click"),d.settings.autoPages?a.jcs4Find(d.settings.controlPages,[d,document]).html(""):a.jcs4Find(d.settings.controlPages,[d,document]).find("a").off("click"),d.queue={}},d.reload=function(a){s("Public reload"),void 0!=a&&(c=a),d.destroy(),e()},e(),this}}(jQuery);